# Compute API
The Compute API defines the replacement for the application servers that were used for SAS 9.  The Compute API enables clients to perform the following tasks:

* Submit and execute SAS code.
* Obtain the SAS log or listing information from executed SAS code.
* View output that is generated by a SAS code submission.
* Access SAS data sets that are created by a SAS code submission.
* Access SAS filerefs that are created by a SAS code submission.
* Access SAS variables that are defined and used in a SAS code submission.
* Retrieve information about engines that are available in a session.

There are endpoints that are described by this API that enable you to perform Create, Read, Update, and Delete operations that
define a Compute context. A Compute context is analogous to the SAS Application Server from the SAS V9 engine. There are also endpoints that
enable you to request a Compute session. A Compute session runs on a SAS Compute Server and serves as
the access point to SAS language processing in this environment. A Compute session replaces the functionality of the SAS Workspace Server and
SAS Stored Process Server from SAS 9.

The Compute API supports the ability for you to perform the following tasks:

* Define a Compute context.
* Manage a Compute context.
* Create a Compute session to work in.
* Reference resources from other APIs.
* Submit a job to run in a Compute session. A job can be a single line of SAS code or a complex SAS program.
* Obtain the log of all submitted SAS code during a Compute session.
* Obtain the listing output of all submitted SAS code during a Compute session.
* Obtain links to results for output that is generated by a job that you submitted during a Compute session.
* Access SAS data sets that are available to you.
* Access files via SAS filerefs that are available to you.
* Access SAS macro variables that are defined during a Compute session.
* Retrieve information about available engines in the system.
* Access or update SAS options that are available during a Compute session.

The Compute API also acts as a provider for the following APIs. The Compute API registers itself as a provider
with the name Compute when it interacts with these APIs.

* Job Execution API
* Data Sources API
* Data Tables API
* Row Sets API


#### Life Cycle Management

There are several resources that are available to the Compute API. These resources have different life
cycles, depending on their usage by clients. This section describes the life cycles of these resources.

##### SAS Compute Server

A SAS Compute Server is a running process. The Compute API forwards requests to the SAS Compute Server for processing.
When a client requests a Compute session from the Compute API, the Compute API determines whether there are any
SAS Compute Servers that can handle the request. The client provides a Compute context when requesting a Compute session,
and the Compute API attempts to find a suitable SAS Compute Server to handle the request for that context. If no
 suitable SAS Compute Server is found, a new SAS Compute Server process is launched, and a Compute session is created for the
 new SAS Compute Server.

##### Compute Session

A Compute session is created on the SAS Compute Server when a client needs to perform tasks. The
client makes a request for a session via the Compute API. The Compute session is the starting point for most actions
that take place inside of the SAS Compute Server. Currently, a Compute session lifetime is controlled by the client. When a
client has completed work with a Compute session, it then uses the appropriate Delete command to destroy the Compute session.

You can configure Compute sessions to timeout after a time of inactivity. You can set the timeout period in the Compute context or in the
Compute session request that you use to create the Compute session. After the specified period of inactivity passes, the session
is destroyed.

**Note:** Compute sessions are strongly tied to the SAS Compute Server that they are running on. A Compute session cannot be migrated to
another SAS Compute Server, and the Compute session state is not maintained if the associated SAS Compute Server fails.

##### Jobs
Jobs are units of SAS code that are executed by the client in the Compute session. A job has a state that describes
where it is in its life cycle. A completed job might continue to be accessed for information such as listings, logs or
results. Output from a job might be available to the data and file endpoints of the Compute session.

After a job is destroyed via the appropriate DELETE request, the log, listing, and result resources that are associated with
that job are no longer available via the jobs path for a session. However, the log, listing, and result resources
are available to the session, and you can reach them via the session/<sessionId> endpoints.

If a session that contained a job is destroyed, then all jobs and all resources that are associated with those jobs are
destroyed as well.

##### Logs, Listings, and Results
The log, listing, and result resources are generated by the execution of a job. However, their lifetime is governed
by the Compute session that the job was executed in. A session can have multiple jobs executed in it. Each of these jobs might
create its own logs, listings, and results. You can access the resources for a particular job by going
directly to the desired endpoint under sessions/<sessionId>/jobs/<jobId>. However, you can also access all logs,
listings, and results for the entire session by going to the corresponding endpoint under sessions/<sessionId>.

When a job is destroyed, the content of the log, listing, and result resources that are associated with that job
are still available via the session. When a session is destroyed, all logs, listings, and results are destroyed, as are all
jobs for that session.

##### Data Access
The Compute session allows access to any data sets that are available. These data sets might be generated from a variety of
sources:

* an underlying SAS configuration, such as sasv9.cfg (for example, SASHELP)
* libraries that are configured when a session or job is requested
* a job that executes in a session

Clients might also use the data endpoints to create libraries and upload data sets that are used by SAS code that is
executed in the same Compute session.

Regardless, generated data sets are associated with a Compute session and are available as long as the Compute session is
available. When a session is destroyed, the generated data sets are no longer available via that session. If the data sets
are part of a persisted data storage area, you can continue to access them. If the generated data sets are stored in a
transient area that is owned by the destroyed Compute session (for example, SASWORK), then the data sets are destroyed
also.

##### File Access
A Compute session enables you to access files that are available to it.

Your Compute session can access files via the /filerefs endpoint with SAS filerefs.
These filerefs are generally created by the SAS code that executes within a job. Clients
might create filerefs via the /filerefs endpoint, and you can use these filerefs in SAS code that executes in
the same Compute session.

These filerefs are associated with a Compute session and are available for the duration of the Compute Session.
When a session is destroyed, associated filerefs are no longer available via that session. If the underlying files are part
of a persisted data storage area, then those files continue to exist. If the files are kept in a transient area owned by a
destroyed Compute session, then those files are also destroyed.

Your Compute session can also access files via the /files endpoint with file or directory paths.
Files or directories can be created through the /files endpoint.
You can also retrieve file or directory properties, upload files, or download files.
Via the /files endpoint, you can also do typical file operations like copy or rename a file.

When you provide a file or directory path in the /files URL, follow these guidelines:

* Replace a forward slash character '/' with "\~fs\~".
* Replace a backward slash character '\\' with "\~rs\~".
* Replace a semicolon character ';' with "\~sc\~".
* Replace a tilde character '\~' with double tildes "\~\~".

#### Attributes
The following attributes can be set in the media types for requests that are used in the Compute API.

##### sessionInactiveTimeout

* Valid: [`Context Request`](https://developer.sas.com/apis/rest/Compute/#application-vnd.sas.compute.context.request), [`Session Request`](https://developer.sas.com/apis/rest/Compute/#application-vnd.sas.compute.session.request)
* Type: Integer
* Units: Seconds

Sets the inactivity timeout for a session.  If specified in a Compute context request, then the attribute is in effect for any
session that is created from that context.  If specified in a session request, then the attribute applies to that session only.

* If the value is positive, then a session is terminated if it is inactive for longer than the specified time period.
* If the value is negative or unset, then the default value of **15 minutes** is used.
* If the value is **0**, then the session does not terminate due to inactivity.

##### resetLogLineNumbers

* Valid: [`Job Request`](https://developer.sas.com/apis/rest/Compute/#application-vnd.sas.compute.job.request)
* Type: Boolean
* Availability: Added in version 2 of the resource.

If this attribute is set for a job request, then the log line numbers are reset to **0** immediately before the job begins
execution.

##### allowXCMD
* Valid: [`Context Request`](https://developer.sas.com/apis/rest/Compute/#application-vnd.sas.compute.context.request)
* Type: String
* Availability:  Added in version 3 of the API.

This attribute instructs the Compute sessions that are created from the Compute context to allow XCMDs.  By default, XCMDs are
disabled. An administrator can choose to enable XCMDs. By setting the value to *"true"*, the administrator
can allow any authorized user of the Compute context to use XCMDs. If the administrator sets the value to a name,
such as *"powerUsers"*, then the users that are members of that Identity group are allowed to use XCMDs.

##### homeDirectory

* Valid: [`Context Request`](https://developer.sas.com/apis/rest/Compute/#application-vnd.sas.compute.context.request), [`Session Request`](https://developer.sas.com/apis/rest/Compute/#application-vnd.sas.compute.session.request)
* Type: String
* Availability:  Added in version 3 of the API.

This attribute specifies the home directory for a Compute session.
All relative paths in /files endpoints are relative to the home directory of a Compute session.
By default, the home directory of a Compute session is set as the current working directory of the Compute server.
The home directory of a Compute session remains as a constant for the duration of that Compute session.
The home directory has the same life time as the Compute session.

##### unsafeJobCharacters

* Valid: [`Context Request`](https://developer.sas.com/apis/rest/Compute/#application-vnd.sas.compute.context.request)
* Type: String
* Availability: Added in version 3 of the API.

This attribute specifies the characters that the Compute session should remove from a value
when the characters are part of a variable value that is received as input to a job.
By default, the following character is stripped out:

* ; (semicolon)

The following characters are masked by the %NRSTR quoting function:

* & (ampersand)
* " (double-quote)
* ' (single-quote)
* % (percent)

When this attribute is set, it lists the characters that should be removed in addition to the characters that are listed above. The characters
that are listed above are always handled in the manner indicated when this attribute is enabled.
If you set this attribute to an empty string (""), then the feature is disabled.
Even when the attribute is disabled, semicolons (;) are always stripped from a variable value.

##### runServerAs

* Valid: [`Context Request`](https://developer.sas.com/apis/rest/Compute/#application-vnd.sas.compute.context.request)
* Type: String
* Availability:  Added in version 3 of the API.

This attribute specifies the account that runs any servers that are launched for this Compute context.
The specified account is considered a shared service account, and all Compute servers that are launched
for this Compute context run under this account. The value should correspond to the user name of a
Service Account Credential that is stored by the Credentials service. See "Service Account Credentials"
in the Examples section for more information.

##### reuseServerProcesses

* Valid: [`Context Request`](https://developer.sas.com/apis/rest/Compute/#application-vnd.sas.compute.context.request)
* Type: Boolean
* Availability:  Added in version 3 of the API.

This attribute enables servers that are launched for this Compute context to be reused. The servers must
also have a *runServerAs* attribute specified.

##### serverInactiveTimeout

* Valid: [`Context Request`](https://developer.sas.com/apis/rest/Compute/#application-vnd.sas.compute.context.request)
* Type: Integer
* Availability:  Added in version 3 of the API.

This attribute is applicable when *reuseServerProcesses* is enabled. The attribute value specifies the amount of time in seconds
that a server is allowed to remain inactive before being terminated. A server is inactive when it has no currently
active Compute sessions.

##### reuseServerLimit

* Valid: [`Context Request`](https://developer.sas.com/apis/rest/Compute/#application-vnd.sas.compute.context.request)
* Type: Integer
* Availability:  Added in version 3 of the API.

This attribute is applicable when *reuseServerProcesses* is enabled. The attribute value specifies the maximum number
of times that Compute sessions can be created on each server that is launched. If this value is _n_, then when
the *n*th Compute session is created, no additional sessions are created. When the *n*th session ends, the server terminates.



## API Request Examples Grouped by Process Type

<details>
<summary>Getting Started</summary>

* [Create a context](#CreateAContext)
* [Run servers under a shared account](#RunServersUnderSharedAccount)
* [Reuse Compute servers](#ReuseComputeServers)
* [Enable XCMD support](#EnableXCMDSupport)
* [Set the home directory for a session](#SetSessionHomeDir)
* [Specify invalid characters for variables](#SpecifyInvalidVarCharacters)
* [Get a list of contexts](#GetContextList)
* [Create a session](#CreateSession)
* [Add session options](#AddSessionOpts)
* [Add resources](#AddResources)
* [Specify the scope of a resource](#ResourceScope)
* [Specify a resource type](#SpecifyResourceType)
* [Specify whether a resource is required](#RuntimeResourceUsage)
* [Specify service account credentials](#SpecifyServiceAccountCredentials)
</details>

<details>
<summary>Running Code</summary>

* [Create a job](#CreateJob)
* [Determine the state of a job](#DetermineJobState)
* [Poll for changes in the state of a job](#PollJobStateChanges)
* [Get the log from a session](#GetSessionLog)
* [Get the log from a job](#GetJobLog)
* [Reset log line numbers](#ResetLineNumbers)
* [Get results from a job](#GetJobResults)
* [Get session variables](#GetSessionVars)
* [Access session options](#AccessSessionOpts)
* [Get available engines](#GetEngines)
</details>

<details>
<summary>Accessing Data</summary>

* [List assigned librefs](#ListAssignedLibrefs)
* [Assign a new libref](#AssignNewLibref)
* [List tables in a libref](#ListLibrefTables)
* [Get column information](#GetColumnInformation)
* [Get row information](#GetRowInformation)
* [Access data via a row set object](#AccessDataViaRowSetObject)
* [Create a data view](#CreateDataView)
* [Update a table](#UpdateTable)
* [Update a table column](#UpdateTableColumn)
* [Delete a table](#DeleteTable)
</details>

<details>
<summary>Accessing Files Via Filerefs</summary>

* [List assigned filerefs](#ListAssignedFilerefs)
* [Assign a new fileref](#AssignNewFileref)
* [Download file from a fileref](#DownloadFileFromFileref)
* [Upload a file to a fileref](#UploadFileToFileref)
* [Upload a Unicode-encoded file to a fileref](#UploadUnicodeFileToFileref)
* [Handle a directory fileref](#HandleDirectoryFileref)
* [Handle a concatenation fileref](#HandleConcatenationFileref)
</details>

<details>
<summary>Accessing Files Via a File or Directory Path</summary>

* [Get the properties of a file or directory](#GetFileDirectoryProperties)
* [Download a file by specifying a file or directory path](#DownloadFileViaPath)
* [Upload a file by specifying a file or directory path](#UploadFileViaPath)
* [Delete a file or directory](#DeleteFileViaPath)
* [List members of a directory](#ListDirMembers)
* [Create a directory](#CreateDirectory)
* [Create an empty file](#CreateFile)
* [Rename a file or a directory](#RenameFileDirectory)
* [Copy a file or directory](#CopyFileDirectory)
</details>

<details>
<summary>Cleanup</summary>

* [End a session](#EndSession)
</details>


#### Getting Started
The following scenarios enable you to get started using the Compute API.

##### <a name='CreateAContext'>Create a Context</a>
To create a context, issue the following request.

```
  POST /compute/contexts
```
An application/vnd.sas.compute.context.request body is required to be submitted with this request. Here is a simple example:

```json
  {
     "name": "MyContext",
     "version": 1,
     "description": "My Application Context",
     "launchContext": {
        "contextName": "launcher_context"
      },
     "launchType": "service",
     "authorizeAllAuthenticatedUsers" : true
  }
```

It is highly recommended that applications that need to use the Compute API use the Compute Service Bootstrapping
project to handle the creation of their contexts for them. See Compute-Bootstrap for more details.

**Note:** Only administrators are allowed to create contexts.

##### <a name='RunServersUnderSharedAccount'>Run Servers under a Shared Account</a>
By default, Compute servers run under the account that is associated with the client token that is provided to the Compute
API.  However, there might be cases when it is preferable to run under a shared service account.
In these cases, the server runs under the shared service account, but the user's identity is used in the session.
This avoids the need to define each end user on the machines or nodes where the Compute server is deployed.

To make Compute servers run under a shared service account, specify a `runServerAs` attribute with the user name of the
service account credential as the value. The service account credential is then used by the Compute context to configure Compute servers. See the
[Specify Service Account Credentials](#SpecifyServiceAccountCredentials) section below for more information.

You can add the `runServerAs` attribute when you create a context:
```
  POST /compute/contexts
```

```json
  {
     "name": "MyContext",
     "version": 1,
     "description": "My Application Context",
     "launchContext": {
        "contextName": "launcher_context"
      },
     "launchType": "service",
     "authorizeAllAuthenticatedUsers" : true,
     "attributes" : {
        "runServerAs" : "myuser"
     }
  }
```

Alternatively, you can add the `runServerAs` attribute when you update an existing context:
```
  PUT /compute/contexts/{contextId}
```

```json
  {
     "name": "MyContext",
     "id" : "{contextId}",
     "version": 1,
     "launchContext": {
        "contextName": "launcher_context"
      },
     "launchType": "service",
     "attributes" : {
        "runServerAs" : "myuser"
      }
  }
```

##### <a name='ReuseComputeServers'>Reuse Compute Servers</a>
By default, a Compute server is used only for a single Compute session. The server terminates when the
session is destroyed. There are cases where it might be useful to continue to run the server so
that it can be reused for a later Compute session. When you enable reuse, a server is reused when reuse is possible.  Servers still
allow only a single session at any given time.

To enable server reuse, you must configure the server to run as a shared account. You can use these attributes
to control the reuse of a Compute server process.

* reuseServerProcesses - A Boolean value that indicates that servers should be reused.
* serverInactiveTimeout - A time-out value, in seconds, that indicates how long an idle
                          server continues to run before it is shut down. A server is idle when it
                          does not currently have an active Compute session. The default value
                          is 600 (10 minutes).
* serverReuseLimit - A value that indicates the maximum number of times that a server can be reused. This value is optional.
                     By default, the server can be reused as
                     many times as necessary. If the limit is specified as *n*, then when the *nth* session is deleted,
                     the server shuts down.
* serverMinAvailable - A value that indicates the minimum number of available servers that the Compute
                     service attempts to keep available.  This value is optional.  When this
                     attribute is set, an application should not need to wait for the launching
                     of a server process when a request for a Compute session is made.

You can specify these attributes when you create a context:
```
  POST /compute/contexts
```

```json
  {
     "name": "MyContext",
     "version": 1,
     "description": "My Application Context",
     "launchContext": {
        "contextName": "launcher_context"
      },
     "launchType": "service",
     "authorizeAllAuthenticatedUsers" : true,
     "attributes" : {
        "runServerAs" : "myuser",
        "reuseServerProcesses" : true,
        "serverInactiveTimeout" : 300,
        "serverReuseLimit" : 10,
        "serverMinAvailable" : 1
     }
  }
```

Alternatively, you can specify these attributes when you update an existing context:
```
  PUT /compute/contexts/{contextId}
```

```json
  {
     "name": "MyContext",
     "id" : "{contextId}",
     "version": 1,
     "launchContext": {
        "contextName": "launcher_context"
      },
     "launchType": "service",
     "attributes" : {
        "runServerAs" : "myuser",
        "reuseServerProcesses" : true,
        "serverInactiveTimeout" : 300,
        "serverReuseLimit" : 10,
        "serverMinAvailable" : 1
      }
  }
```

##### <a name='EnableXCMDSupport'>Enable XCMD Support</a>
By default, Compute sessions do not allow XCMDs to be executed. If users need XCMD support, the administrator
can enable it by setting the `allowXCMD` attribute in the context. A value of *"true"* enables any
user of the context to obtain XCMD access.  For more information about the usage of the XCMD option, see
[XCMD System Option](https://documentation.sas.com/?cdcId=pgmsascdc&cdcVersion=9.4_3.5&docsetId=hostunx&docsetTarget=n02699r064oqccn19vblte8xzr8m.htm).

You can enable XCMD support when you create a context:
```
  POST /compute/contexts
```

```json
  {
     "name": "MyContext",
     "version": 1,
     "description": "My Application Context",
     "launchContext": {
        "contextName": "launcher_context"
      },
     "launchType": "service",
     "authorizeAllAuthenticatedUsers" : true,
     "attributes" : {
        "allowXCMD" : "true"
     }
  }
```

Alternatively, you can enable XCMD support when you update an existing context:
```
  PUT /compute/contexts/{contextId}
```

```json
  {
     "name": "MyContext",
     "id" : "{contextId}",
     "version": 1,
     "launchContext": {
        "contextName": "launcher_context"
      },
     "launchType": "service",
     "attributes" : {
        "allowXCMD" : "true"
     }
  }
```

As an administrator, if you need to provide XCMD access to a certain group of context users only, then
you can set the `allowXCMD` attribute to be available to that group's account ID. For example, if a group
named Power Users has the account ID `powerUsers`, you can provide XCMD support to that group with this
code example:

```
  PUT /compute/contexts/{contextId}
```

```json
  {
     "name": "MyContext",
     "id" : "{contextId}",
     "version": 1,
     "launchContext": {
        "contextName": "launcher_context"
      },
     "launchType": "service",
     "attributes" : {
        "allowXCMD" : "powerUsers"
     }
  }
```

##### <a name='SetSessionHomeDir'>Set the Home Directory for a Session</a>
To specify the home directory for a session, set the `homeDirectory` attribute in the Compute context
or in a session request body.

This is an example of an application/vnd.sas.compute.context.request
that sets the home directory of the session during context creation:

```
  POST /compute/contexts
```

```json
  {
     "name": "MyContext",
     "version": 1,
     "description": "My Application Context",
     "launchContext":
      {
        "contextName": "launcher_context"
      },
     "launchType": "service",
     "authorizeAllAuthenticatedUsers" : true,
     "attributes" :
      {
        "homeDirectory" : "/h/myhome"
      }
  }
```

This is an example of an application/vnd.sas.compute.session.request
that sets home directory of a session during session creation:

```
  POST /compute/contexts/{contextId}/sessions
```

```json
   {
     "version": 1,
     "name": "MySession",
     "description": "This is my session for doing some simple work.",
     "attributes": {
        "homeDirectory" : "/h/myhome"
     }
   }
```

##### <a name='SpecifyInvalidVarCharacters'>Specify Invalid Characters for Variables</a>
Compute sessions protect against code injection by using variables that are provided to jobs.
Variable values are processed and the following character is removed by default:
* ; (semicolon)

Also, these characters are masked by the %NRSTR quoting function by default:
* & (ampersand)
* " (double-quote)
* ' (single-quote)
* % (percent)

An administrator controls how invalid characters are handled by using the `unsafeJobCharacters` attribute on the context.
This attribute enables the administrator to determine which characters to remove.

If you set the `unsafeJobCharacters` attribute, a variable value is examined one character at a time, and any characters
that you specify are removed. The five default characters are always handled in the manner described above. Do not use commas or colons in the
attribute value unless you intend to remove them from variable values.

If you set the `unsafeJobCharacters` attribute to the empty string, no character except the semicolon (;)
is processed.

You can set the `unsafeJobCharacters` attribute when you create the context:
```
  POST /compute/contexts
```

```json
  {
     "name": "MyContext",
     "version": 1,
     "description": "My Application Context",
     "launchContext": {
        "contextName": "launcher_context"
      },
     "launchType": "service",
     "authorizeAllAuthenticatedUsers" : true,
     "attributes" : {
        "unsafeJobCharacters" : "&';"
     }
  }
```

Alternatively, set the `unsafeJobCharacters` attribute when you update an existing context.
```
  PUT /compute/contexts/{contextId}
```

```json
  {
     "name": "MyContext",
     "id" : "{contextId}",
     "version": 1,
     "launchContext": {
        "contextName": "launcher_context"
      },
     "launchType": "service",
     "attributes" : {
        "unsafeJobCharacters" : "&;%"
     }
  }
```

##### <a name='GetContextList'>Get a List of Contexts</a>
To get a list of currently defined contexts, issue the following request.

```
  GET /compute/contexts
```
An application/vnd.sas.collection is returned from this request. Standard paging, filtering, and sorting options are
 allowed in a request. Here are some examples.

```
  GET /compute/contexts?start=2&limit=5
  GET /compute/contexts?filter=(startsWith(name,SASStudio)
```
**Note:** The previous filter is for example purposes only. There is no implication that name or SASStudio are valid
parameters for a filter on your request.

##### <a name='CreateSession'>Create a Session</a>
To create a session, make a request to the sessions endpoint of the Compute API. Send an
application/vnd.sas.compute.session.request body with the following request to set other parameters on the session as
needed.

```
   POST /compute/contexts/{contextId}/sessions
```
In this example, contextId refers to a Compute context that is known to the Compute API. The response to this request
includes information and links to the Compute session that was created by application/vnd.sas.compute.session.

**Notes:**
* Only users who are allowed to use the context can create a session. This is governed by the authentication rules
that are defined when the context is created.
* The Compute server process runs under the identity of the user that is requesting the session.

##### <a name='AddSessionOpts'>Add Session Options</a>
A session can be created with customized start up options that use the options array in the environment object of
application/vnd.sas.compute.session.request.

The options apply directly to the SAS session that is started.

An example would be:
```json
   {
     "version": 1,
     "name": "MySession",
     "description": "This is my session for doing some simple work.",
     "attributes": {

     },
     "environment": {
       "options": [
        "memsize=4g",
        "fullstimer"
       ]
     }
   }
```

Here is the order in which options are processed:

* !SASROOT/sasv9.cfg
* !SASROOT/sasv9_samples.cfg
* !SASROOT/nls/<lang>/sasv9.cfg
* !SASROOT/sasv9_local.cfg
* $USER/sasv9.cfg
* Context environment options
* Session environment options

Session environment options have the highest priority.

##### <a name='AddResources'>Add Resources</a>

You can reference resources from other services when you are using your Compute session
or when you are executing jobs in your Compute session. You can add resources to your Compute
context, to your Compute session, or to your job execution request.

Resources that you add to your Compute context are available to any Compute
session that is instantiated from that context. These resources are stored with
the context definition.

You can specify resources when you request a Compute session as part of a
session request. These resources are available only to the session in which they
were requested. A session-requested resource takes precedence over a
context-requested resource.

When executing a job in the Compute API, the job request can also accept resources.
Resources that are included in a job request take precedence over resources that are requested
for a session.

To use resources, give the resource a name and provide the resource URI and resource type
in the request. Here is a simple example:

```json
   {
   "name" : "file1",
   "uri" : "/files/files/fedcba98-7654-3210-fedc-ba9876543210",
   "type" : "application/vnd.sas.file"
    }
```
This resource directs the Compute server to assign the object that is located at
/files/files/fedcba98-7654-3210-fedc-ba9876543210 to file1. The type value application/vnd.sas.file
indicates to the Compute server that this is a fileref. Therefore, when this
resource is applied, you can reference the resource
/files/files/fedcba98-7654-3210-fedc-ba9876543210 by using the fileref file1.

###### <a name='ResourceScope'>Specify the Scope of a Resource</a>
You can add resources to any job or session request. For resources that are
added to a session request, the resource has SESSION scope. This means that the
resource is available throughout the entire session. For resources that are
added to a job request, the user determines the scope. The scope member of the
resource enables you to specify whether the scope is JOB or SESSION. A resource
with JOB scope is cleared when the job completes. A resource with SESSION scope
remains after the job completes.

###### <a name='SpecifyResourceType'>Specify a Resource Type</a>
Here are the currently supported types that you can use as a resource.

* **application/vnd.sas.file** - For resources of this type, the Compute server
expects the URI to point to a Files API resource, and the Compute server creates
a fileref for that resource. The name that you provide becomes the fileref. Any
options that are specified become options for the assigned fileref, similar to
how you define a fileref in a FILENAME statement. For filerefs that have JOB
scope, the fileref is deassigned when the associated job completes.
Resources that are marked for output use are shown in the results.

* **application/vnd.sas.preference** - For resources of this type, the Compute
server expects the URI to point to a Preferences API resource. A macro variable
with the same name as the Preferences resource is created, and the macro
variable is assigned to the value of the Preferences resource. You can then
access this macro variable in your code. For resources that are assigned JOB
scope, the macro variable is deleted when the associated job completes.
Variables are never shown in results, so the output member has no effect here.

* **application/vnd.sas.data.source.definition** - For resources of this type, the
Compute server expects the URI to point to a source definition
resource that has been created using the DataSources API. A SAS libref with the same name as the source definition resource is
created, and the libref is defined to reference the information that is stored in this
source definition resource. Your code can then access this SAS libref and the tables
that are available in this library. For resources that are assigned JOB scope, the
libref is deassigned when the associated job completes.

##### <a name='RuntimeResourceUsage'>Specify Whether a Resource is Required</a>
By default, resources are not required to be available when they are used by a session or job.
That is, if the item defined by a resource cannot be created during the
session or job initialization, the session or job is not put into a Failed
state. If a resource must be available to a session or job, then set the `Required`
member of the resource to true. This indicates that a session or
job must fail if the resource cannot be created.

##### <a name='SpecifyServiceAccountCredentials'>Specify Service Account Credentials</a>
Service account credentials allow Compute servers to be run under a specific shared service
account rather than the end-user account. Service account credentials allow users who do not have an account on the
Compute server host to use a Compute server.

Many service account credentials can exist in the Credentials service at any given time. The
Compute context specifies which service account credential to use, if any, when starting a
SAS Compute Server. Specify a service account credential by providing the user name for the
service account credential as the value for the `runServerAs` attribute in the Compute context.

The Credentials API must be used to define a service account credential. All service
account credentials need to be owned by the Compute service. The Credentials service
allows the Compute service only one credential per domain. Therefore, each service account credential
must be in its own domain. When you create a new service account credential, you must send
two requests to the Credentials service. The first request creates a new domain,
and the second request adds the service account credential to the domain.

The following example shows the requests that are necessary to create a service account credential
for the user *userName* with password *password* (BASE64 encoded as *cGFzc3dvcmQ=*). The
domain ID can be any unique value such as a UUID. These requests must be performed by a
user in the SAS Administrators group.

```
PUT /credentials/9fba5e25-9238-4d02-8a2f-ece09cccc2dd/domainId
```
```json
{
    "id": "9fba5e25-9238-4d02-8a2f-ece09cccc2dd",
    "label": "userName",
    "type": "compute-password",
    "version": 1,
    "description": "Service Account Credential for userName"
}
```

```
PUT /credentials/domains/9fba5e25-9238-4d02-8a2f-ece09cccc2dd/clients/sas.compute
```
```json
{
    "domainId": "9fba5e25-9238-4d02-8a2f-ece09cccc2dd",
    "domainType": "compute-password",
    "identityId": "sas.compute",
    "identityType": "client",
    "properties": {
        "userId": "userName"
    },
    "secrets": {
        "password": "cGFzc3dvcmQ="
    }
}
```


#### Running Code
The following scenarios describe how to run SAS code in the Compute API and how to obtain information about the code that
was executed.

##### <a name='CreateJob'>Create a Job</a>
To execute SAS code, submit an application/vnd.sas.compute.job.request request to the jobs endpoint. The
request body contains information about the job that you are running. This information includes the code to execute and any
SAS options or environment variables that are needed for the job. A link is provided in the response when a session is
created or queried.

```
   POST /compute/sessions/{sessionId}/jobs
```
The SAS code is executed asynchronously. The request above returns immediately with an
application/vnd.sas.compute.job response. This response includes information about the job and links that enable you to
find other information about the job.

##### <a name='DetermineJobState'>Determine the State of a Job</a>
Because the SAS code that is submitted in a job is executed asynchronously, you might need to
determine the state of a job as it executes. The job has a state endpoint that you can query to
determine its current state. A link is provided when a job is created.

```
   GET /compute/sessions/{sessionId}/jobs/{jobId}/state
```
The possible values for job state and the meaning of each value are defined in the following list:

* `pending` - The job has been submitted but has not started to execute.
* `running` - The job is running.
* `canceled` - The job has been canceled.
* `error` - The job completed with an error.
* `warning` - The job completed with a warning but no errors.
* `completed` - The job completed without errors or warnings.

The first two states above are intermediate states.  The last four states are terminal states.

##### <a name='PollJobStateChanges'>Poll for Changes in the State of a Job</a>
It is possible to submit a request for job state that does not return until the job state changes or
until a specified amount of time has elapsed. You can do this by submitting a request like
the example below, specifying an If-None-Match HTTP header with an ETag value. The ETag value can
be obtained by submitting an ordinary request for job state, as shown in the previous example. The
value for the query parameter wait is an unsigned integer that represents the number
of seconds to wait. Valid values for wait range from 0 to 60. Any value greater than
60 is treated as if you had specified 60.

```
   GET /compute/sessions/{sessionId}/jobs/{jobId}/state?wait=30
```
After the request is received, if the job state changes to another state, the new job state is
returned with an HTTP code of 200. If the
job state does not change, the response is delayed until the job state changes or until the
specified number of seconds has elapsed. If the job state changes before the specified number of
seconds has elapsed, the value of the new state is returned with an HTTP code of 200. If the
specified number of seconds elapses without a job state change, the Compute service responds
with an HTTP code of 304 (Not Modified), and no ETag header is provided with the response.


##### <a name='GetSessionLog'>Get the Log from a Session</a>

A Compute session keeps track of the SAS log that is associated with the code that has been executed in a session. You
might need to query the log to display to a user or to check for errors or warnings that were generated during SAS code
processing. To obtain the Compute session log, make a request to the following endpoint.

```
   GET /compute/sessions/{sessionId}/log
```
You can add query parameters to a request. The most useful is the time-out parameter that enables long polling
for an endpoint. The time-out value tells the Compute server the maximum time (in seconds) to wait
for at least one line of output to be generated that meets the criteria specified by the other query parameters,
as shown in the following example:

```
   GET /compute/sessions/{sessionId}/log?timeout=30
```
By default, the response to this request is a collection of application/vnd.sas.compute.logline entries that describe the
lines of the session log.  However, if the Accept header on the request specifies text/plain, the entire session log is returned
as ordinary text encoded in UTF-8 with CRLF as the line delimiters.  No query parameters are honored when requesting
the output as plain text.

##### <a name='GetJobLog'>Get the Log from a Job</a>

The Compute service has the ability to return log information for a single submitted job. The log
from a job is a subset of the log from the Compute session. The request itself is similar.

```
   GET /compute/sessions/{sessionId}/jobs/{jobId}/log
```
You can add query parameters to a request. The most useful is the time-out parameter, that enables long polling
for an endpoint. The time-out value tells the Compute server the maximum time (in seconds) to wait
for at least one line of output to be generated that meets the criteria specified by the other query parameters or
for the job to end, as shown in the following example:

```
   GET /compute/sessions/{sessionId}/jobs/{jobId}/log?timeout=30
```
By default, the response to this request is a collection of application/vnd.sas.compute.logline entries that describe the
lines of the job log.  However, if the Accept header on the request specifies text/plain, the entire job log is returned
as ordinary text encoded in UTF-8 with CRLF as the line delimiters.  No query parameters are honored when requesting
the output as plain text.

##### <a name='ResetLineNumbers'>Reset Log Line Numbers</a>

SAS code generates line numbers in the log as it processes. If you use the same session for multiple jobs, it
might be useful to reset the log line numbers before each job runs. You can do this in a job request. Using the same POST
request that you use to create a job, provide an attribute named *resetLogLineNumbers* that forces the session to reset
the log line number before executing the next job.

```
   POST /compute/sessions/{sessionId}/jobs

   {
      "code" : [
         "data x;",
         "a=1;",
         "run;"
         ],
      "attributes" : {
         "resetLogLineNumbers" : true
         }
   }
```

##### <a name='GetJobResults'>Get Results from a Job</a>

Many jobs create some type of result. For these jobs, a results endpoint is available that gets the
output that is generated by a job. To get the results information, submit the following request.

```
  GET /compute/sessions/{sessionId}/jobs/{jobId}/results
```
The response is a collection of application/vnd.sas.compute.result items that include information about the results.
There is a link in each item that takes you to a location where you can download the content.

##### <a name='GetSessionVars'>Get Session Variables</a>

SAS code that executes in a session can use or can create macro variables. You can access these variables before or
after a job has executed. To get variable information from a session, submit the following request.

```
  GET /compute/sessions/{sessionId}/variables
```
The response is a collection of application/vnd.sas.compute.session.variable items that return the value of the
variables. This endpoint supports filtering using the EQ, OR, or AND filtering functions.

```
  GET /compute/sessions/{sessionId}/variables?filter=or(eq(name,AFDSID),eq(name,SYS_COMPUTE_SESSION_ID))
```

You can also request a variable directly from the session. Simply request the variable directly.  A link to
the variable is provided by the resource in the collection as well.

```
  GET /compute/sessions/{sessionId}/variables/SYS_COMPUTE_SESSION_ID
```

If you are interested in only the value of the requested variable, then set the Accept header for the request to text/plain,
and the value is returned as text.

```
  GET /compute/sessions/{sessionId}/variables/SYS_COMPUTE_SESSION_ID
  Accept: text/plain
```

##### <a name='AccessSessionOpts'>Access Session Options</a>
You can access SAS options via the options endpoint on the session. To get the value of a specific SAS option that is
used in the session, such as VALIDVARNAME, submit the following request.

```
  GET /compute/sessions/{sessionId}/options/VALIDVARNAME
```
The response can either be returned as a string or as an application/vnd.sas.compute.session.option resource.  The default
behavior is to return the option as a string using plain text. However, if you require more information about an option,
set the Accept header to application/vnd.sas.compute.session.option+json.

You can update options using the same endpoint. Use a PUT request, and provide a text body to update a value.
```
  PUT /compute/sessions/{sessionId}/options/VALIDVARNAME
  Content-Type: text/plain
  ...
  ANY
```
Some options cannot be updated after initialization. If you request to update an option that falls in this
category, a 400 error is returned.

##### <a name='GetEngines'>Get Available Engines</a>

To support the Data Sources API, you can request the list of available SAS libref engines for
a Compute context. To get the list of available engines from the Compute service, submit the following
request.

```
  GET /compute/sessions/{sessionId}/engines
```
The response is a collection of application/vnd.sas.data.engine items that return information about each engine.

#### Accessing Data
The following scenarios describe how to access SAS data sets via librefs. These librefs might be previously
assigned, created by executing SAS code, or assigned directly via the API.

##### <a name='ListAssignedLibrefs'>List Assigned Librefs</a>
If you need to obtain the list of librefs that are currently defined in your session, query the data
endpoint. No request body is required on this GET request. A collection of application/vnd.sas.compute.library.summary
items is returned that gives you access to the librefs that are currently defined.

```
   GET /compute/sessions/{sessionId}/data
```
You can provide query parameters to this method for pagination to limit the number of items that is returned. The default
limit is 10. Follow the self links in the responses to access the actual application/vnd.sas.compute.library items.

##### <a name='AssignNewLibref'>Assign a New Libref</a>

To assign a new libref, submit an application/vnd.sas.compute.library.request to the data endpoint. This request contains
information about the libref that you want to assign.

```
  POST /compute/sessions/{sessionId}/data
```
Information about the newly assigned libref is returned to you in an application/vnd.sas.compute.library item.

##### <a name='ListLibrefTables'>List Tables in a Libref</a>
To get a listing of all tables in a libref, send a request to the libref for a collection. You must use the Accept header
to get the list of tables. Otherwise, you receive libref properties from application/vnd.sas.compute.library. The collection
that is returned contains application/vnd.sas.compute.data.table.summary items.

```
  GET /compute/sessions/{sessionId}/data/{libref}
  Accept: application/vnd.sas.collection+json
```
Links to the individual tables are provided. Follow the links to access the tables.

##### <a name='GetColumnInformation'>Get Column Information</a>
To obtain column information about a table, send a column request to the table. This request returns
a collection of application/vnd.sas.compute.data.table.column entries that describe each column. A link to this call
is provided in the application/vnd.sas.compute.library object, under columns.

```
  GET /compute/sessions/{sessionId}/data/{libref}/{tableName}/columns
```
Information, such as the label, length, and type of a column, is returned in these entries.

##### <a name='GetRowInformation'>Get Row Information</a>
To get information about rows, submit a request to the rows endpoint of the table. You get a collection of
application/vnd.sas.compute.data.table.row entries that describe each row. A link to this call is provided in the
application/vnd.sas.compute.library object, under rows.

```
  GET /compute/sessions/{sessionId}/data/{libref}/{tableName}/rows
```
The actual data in the data set or table is returned here. By default, the data is formatted. If you want the raw,
unformatted data from the table, add the formatted query parameter and assign a value of false.

For the request above, several options can be passed as query parameters. You can convert the request can into
a POST request and pass the query parameters as part of the request body. You might do this when
the values of the query parameters are exceptionally long, they contain special characters, or they contain sensitive
information.

**Note:** The WHERE clause that is used here is a standard SAS WHERE clause.

```
  POST /compute/sessions/{sessionId}/data/{libref}/{tableName}/rows

  {
     "where" : "x=1"
  }
```

##### <a name='AccessDataViaRowSetObject'>Access Data via a Row Set Object</a>

You can access data by using a row set object. Row sets contain column and information together, and they allow
more filtering features than simply obtaining the rows. An application/vnd.sas.compute.data.table.row.set object is
returned.

```
  GET /compute/sessions/{sessionId}/data/{libref}/{tableName}/rowSet
```

For the request above, several options can be passed as query parameters. You can convert the request into
a POST request and pass the query parameters as part of the request body. You might do this when the
values of the query parameters are exceptionally long, when they contain special characters, or when they contain sensitive
information.

**Note:** The WHERE clause that is used here is a standard SAS WHERE clause.

```
  POST /compute/sessions/{sessionId}/data/{libref}/{tableName}/rowSet

  {
     "where" : "x=1",
     "sortBy" : [
        {
        "key" : " my special column"
        }
     ]
  }
```

The formatted value of the cells that are returned in the row set can be changed by specifying the `columnFormatting` member
on a POST request. An example that returns a row set for a specific table where column `a` should be formatted using BEST12.,
is shown here:

```
  POST /compute/sessions/{sessionId}/data/{libref}/{tableName}/rowSet

  {
       "columnFormatting": [
          {
           "name": "a",
           "format": "BEST12."
          }
       ]
  }
```
##### <a name='CreateDataView'>Create a Data View</a>
You can create a view of an existing data set. You might do this to perform multiple tasks on a subset
of an existing data set or table. You might also do this to add sort indexes to a table that does not currently
have the ability to be sorted. To create a view, make a request similar to the following. A request body that indicates
the parameters for the creation of the view is provided.

**Note:** The WHERE clause that is used here is a standard SAS WHERE clause.

```
  POST /compute/sessions/{sessionId}/data/{libref}/{tableName}/views

  {
     "where" : "a=1',
     "sortBy" : [
        {
        "key" : " my special column"
        },
     "distinct" : true
  }
```

If the request is successful, an application/vnd.sas.compute.data.table response is returned.  This response can be used
like any other table that is returned from a session. You can request a row set for a table, or you can request individual
rows and columns. A view is available for use until either the session is destroyed or until the view is deleted.

##### <a name='UpdateTable'>Update a Table</a>
For a table that you can update, you can submit a request to rename the table or to update the label for the
table. Submit a PUT request that contains the information that you want to update. Members that you cannot update
or have not changed are ignored. Here is an example that renames the table WORK.TEST that has label MYTEST to be called
WORK.SUCCESS with label GOOD.

```
   PUT /compute/sessions/{sessionId}/data/WORK/MYTEST

   {
      "name" : "SUCCESS",
      "label" : "GOOD"
   }
```

If the update succeeds, new links are generated that reference the new table name. For a table in the WORK folder,
reference the table using this new name for the remainder of the session. If the table or data set is in a
persisted location, then the changes are persisted.

##### <a name='UpdateTableColumn'>Update a Table Column</a>
For tables that you can update, you can submit a request to update a column in the table.  Supported
updates for a column include the column name, label, format, and informat. Submit a PUT request that contains
the information that you want to update. Members that you cannot update or have not changed are ignored. Here is an
example that renames the ID column in table WORK.TEST to be USER.

```
   PUT /compute/sessions/{sessionId}/data/WORK/MYTEST/ID

   {
      "name" : "USER"
   }
```

If the update is successful, new links are generated that reference the new column name. For a table in the WORK folder,
you can refer to the column using the new name for the remainder of the session. For a table or data set in a
persisted location, the changes are persisted.

##### <a name='DeleteTable'>Delete a Table</a>
If you have the correct permissions, you can delete a table or data set by submitting a request to DELETE the resource.

```
  DELETE /compute/sessions/{sessionId}/data/{libref}/{tableName}
```


#### Accessing Files via Filerefs
The following are descriptions of how to work with files via filerefs in the Compute service. The term fileref is based on the
concept of a SAS fileref.

##### List Assigned Filerefs <a name='ListAssignedFilrefs'>List Assigned Filerefs</a>
To obtain the listing of filerefs that are currently assigned in your session, submit a GET request to the filerefs
endpoint. A collection of application/vnd.sas.compute.fileref.summary objects is returned.

```
  GET /compute/sessions/{sessionId}/filerefs
```
Links are provided to access the individual filerefs themselves.

##### <a name='AssignNewFileref'>Assign a New Fileref</a>
To assign a new fileref, submit an application/vnd.sas.compute.fileref.request to the filerefs endpoint. This request
contains the path and access method to use for the fileref and the requested name of the fileref.

```
  POST /compute/sessions/{sessionId}/filerefs
```

##### <a name='DownloadFileFromFileref'>Download a File from a Fileref</a>
To download the underlying file from a fileref, submit a GET request to the content endpoint. The server attempts
to determine the content of the file and to set that on the Content-type header of the response. If the content cannot be
determined, the header is set to application/octet-stream.

```
  GET /compute/sessions/{sessionId}/filerefs/{filreref}/content
```

##### <a name='UploadFileToFileref'>Upload a File to a Fileref</a>
To upload a file to the server using a fileref, submit a PUT request to the content endpoint for that fileref. The
body of the request is written to the file.

```
  PUT /compute/sessions/{sessionId}/filerefs/{filreref}/content
  If-Match: "<etag>"
```
Conditional PUT support is enabled for this endpoint. To submit data to update the fileref, the current ETag must be
provided.

##### <a name='UploadUnicodeFileToFileref'>Upload a Unicode-encoded File to a Fileref</a>
In following example, a fileref "myref" is assigned to a Unicode-encoded physical file "NC_Counties.shp".
When a 'uploadFileContent' operation is performed through "myref" fileref,
SAS would write out a BOM (byte-order marker) prefix by default.
To avoid a BOM prefix written out, set SAS system option BOMFILE as NOBOMFIE.
Refer to SAS documentation on BOMFILE option for more details.
```
  POST /compute/sessions/{sessionId}/filerefs

  {
  "accessMethod": "DISK",
  "name": "myref",
  "options": "encoding='utf8' recfm=D termstr=LF",
  "path": "/sasuser/NC_Counties.shp",
  }

  PUT /compute/sessions/{sessionId}/filerefs/myref}/content
  If-Match: "<etag>"
  Content-Type: application/octet-stream
```

##### <a name='AppendFileToFileref'>Append a File to a Fileref</a>
To append a file to the server that is using the fileref, submit a POST request to the content endpoint for that fileref.
The body of the request is appended to the file.

```
  POST /compute/sessions/{sessionId}/filerefs/{filreref}/content
```

##### <a name='HandleDirectoryFileref'>Handle a Directory Fileref</a>
If a fileref refers to a directory rather than a single file, you can get a directory listing by setting the Accept
header on the GET request for the content endpoint to application/vnd.sas.collection. A collection of
application/vnd.sas.compute.fileref.directory.member objects is returned.

```
  GET /compute/sessions/{sessionId}/filerefs/{fileref}/content
  Accept: application/vnd.sas.collection+json
```
Links are provided so that you can access the underlying files in the directory. Shortcuts are also provided to create
filerefs for the member entries.

**Note:** Directories are currently Read-only. You can update individual members in the
directory, but updating the directory as a whole is not currently supported.

To download a member file from the directory, submit a GET request to the content endpoint for the directory fileref
with a member query parameter. The server attempts to determine the content of the file and to set that content on the
Content-type header of the response. If the content cannot be determined, the header is set to application/octet-stream.

```
  GET /compute/sessions/{sessionId}/filerefs/{filreref}/content?member={memberName}
```
To upload a member file in the directory, submit a PUT request to the content endpoint for the directory fileref with
a member query parameter. The body of the request is written to the file.

```
  PUT /compute/sessions/{sessionId}/filerefs/{filreref}/content?member={memberName}
```
To append a member file in the directory, submit a POST request to the content endpoint for the directory fileref with
 a member query parameter. The body of the request is appended to the file.

```
  POST /compute/sessions/{sessionId}/filerefs/{filreref}/content?member={memberName}
```

##### <a name='HandleConcatenationFileref'>Handle a Concatenated Fileref</a>
In some cases, a fileref refers to a concatenated list of flat files, such as "('file1.txt' 'file2.txt' ..)".
A GET request to the content endpoint for this type of fileref downloads the content of all the flat files in the
concatenation list.
```
  GET /compute/sessions/{sessionId}/filerefs/{fileref}/content
```
A PUT request on the content endpoint for this type of fileref uploads content to the first file in the
concatenation list.
```
  PUT /compute/sessions/{sessionId}/filerefs/{fileref}/content
```
In some cases, a fileref refers to a concatenated list of directories, such as "('dir1' 'dir2' ...)".
A GET request on the content endpoint for this type of fileref returns a list of all members in all
directories in the concatenation list.
```
 GET /compute/sessions/{sessionId}/filerefs/{fileref}/content
```
A fileref that refers to a concatenation of files and directories is not supported and receives an error at fileref
assignment.

#### Accessing Files via a File or Directory Path
The following are descriptions of how to work with files via file paths in the Compute service.

##### <a name='GetFileDirectoryProperties'>Get the Properties of a File or Directory</a>
To get properties of a file or directory, submit a GET request.
```
  GET /compute/sessions/{sessionId}/files/{fileOrDirectoryPath}
```

##### <a name='DownloadFileViaPath'>Download a File by Specifying the File or Directory Path</a>
To download content of a file, submit a GET request to the files `content` endpoint.
```
  GET /compute/sessions/{sessionId}/files/{fileOrDirectoryPath}/content
```

##### <a name='UploadFileViaPath'>Upload a File by Specifying the File or Directory Path</a>
To upload content to a file, submit a PUT request to the files `content` endpoint.
```
  PUT /compute/sessions/{sessionId}/files/{fileOrDirectoryPath}/content
```

##### <a name='DeleteFileViaPath'>Delete a File or Directory</a>

To delete a file or directory, submit a GET request.
```
  DELETE /compute/sessions/{sessionId}/files/{fileOrDirectoryPath}
```

##### <a name='ListDirMembers'>List Members of a Directory</a>

To list all members of a directory, submit a GET request to the files `members` endpoint.
```
  GET /compute/sessions/{sessionId}/files/{directoryPath}/members
```

##### <a name='CreateDirectory'>Create a Directory</a>

To create a directory, submit a POST request with a request body of type application/vnd.sas.compute.file.properties.
The URL specifies the directory path.  The request body specifies the directory name.
The `isDirectory` attribute should be set as *true*.
```
  POST /compute/sessions/{sessionId}/files/{directoryPath}
```

##### <a name='CreateFile'>Create an Empty File</a>

To create an empty file, submit a POST request with a request body of type application/vnd.sas.compute.file.properties.
The URL specifies the directory path.  The request body specifies the file name.
The `isDirectory` attribute should be set as *false*.
```
  POST /compute/sessions/{sessionId}/files/{directoryPath}
```

##### <a name='RenameFileDirectory'>Rename a File or a Directory</a>
To rename a file or directory, submit a PUT request with a request body of type application/vnd.sas.compute.file.properties.
The URL specifies the original file or directory path.
The request body specifies the new name and path.
```
  PUT /compute/sessions/{sessionId}/files/{originalfileOrDirectoryPath}
```

##### <a name='CopyFileDirectory'>Copy a File or Directory</a>
To copy a file or directory, submit a POST request with a request body of type application/vnd.sas.compute.file.request.
The request body specifies the source name and path.
The URL specifies the destination file or directory path.
```
  POST /compute/sessions/{sessionId}/files/{destinationfileOrDirectoryPath}
```

#### Cleanup

##### <a name='EndSession'>End a Session</a>
Once all work is done in a session, the session should be closed by the user. To do this, submit the following request.

```
   DELETE /compute/sessions/{sessionId}
```
This forces the Session to be destroyed.

**Note:** All resources, logs, results, jobs, and so on that are tied directly to this session are also destroyed and
are no longer reachable.


version 5, last updated 19 March, 2021